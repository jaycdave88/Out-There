<h1>WELCOME</h1>

<!DOCTYPE html>
<html>
<head>
	<title>Remove Markers</title>

	<style>
	html, body, #map-canvas {
		height: 300px;
		width: 100%;
		margin: 0px;
		padding: 0px
	}
	#panel {
		position: absolute;
		top: 5px;
		left: 50%;
		margin-left: -180px;
		z-index: 5;
		background-color: #fff;
		padding: 5px;
		border: 1px solid #999;
	}
	</style>
	<script src="https://maps.googleapis.com/maps/api/js?v=3.exp"></script>
	<script src="https://code.jquery.com/jquery-2.1.1.min.js"></script>
	<script>
// In the following example, markers appear when the user clicks on the map.
// The markers are stored in an array.
// The user can then click an option to hide, show or delete the markers.
var map;
var markers = [];
var location_lat = false;
var location_long = false;

function initialize() {
	var haightAshbury = new google.maps.LatLng(37.7845732, -122.39744000000002);
	var mapOptions = {
		zoom: 12,
		center: haightAshbury,
		mapTypeId: google.maps.MapTypeId.TERRAIN
	};
	map = new google.maps.Map(document.getElementById('map-canvas'),
	                          mapOptions);

  // This event listener will call addMarker() when the map is clicked.
  google.maps.event.addListener(map, 'click', function(event) {
  	addMarker(event.latLng);
  });

  // Adds a marker at the center of the map.
  addMarker(haightAshbury);
}

// Add a marker to the map and push to the array.
function addMarker(location) {
	var marker = new google.maps.Marker({
		position: location,
		map: map,
    draggable:true //will add the ablility to drag the marker around the screen
  });
	$.ajax({
		url: "http://maps.googleapis.com/maps/api/geocode/json?latlng=" + marker.position.k + ","  + marker.position.B,
		type: 'get'
	})
	.done(function(response) {
		var arrayLength = response.results[1].address_components.length;

		location_lat = response.results[1].geometry.location.lat
		location_long = response.results[1].geometry.location.lng

		// console.log(location_lat);
		// console.log(location_long);
	})
	markers.push(marker);
}

// Sets the map on all markers in the array.
function setAllMap(map) {
	for (var i = 0; i < markers.length; i++) {
		markers[i].setMap(map);
	}
}

// Removes the markers from the map, but keeps them in the array.
function clearMarkers() {
	setAllMap(null);
}

// Shows any markers currently in the array.
function showMarkers() {
	setAllMap(map);
}

// Deletes all markers in the array by removing references to them.
function deleteMarkers() {
	clearMarkers();
	markers = [];
}

google.maps.event.addDomListener(window, 'load', initialize);


		// 	var location_lat = response.results[1].geometry.location.lat
		// var location_long = response.results[1].geometry.location.lng

		// console.log(location_lat);
		// console.log(location_long);

		var access_token = "271040506.73a0892.1377628b149643e4af2cc615f424fbdf";




		$(document).ready(function(){
			$('.button').click(function getPhotos(){
				var mediaEndPoint = ("https://api.instagram.com/v1/media/search?lat=" + location_lat + "&lng=" + location_long + "&access_token=" + access_token);
				console.log(mediaEndPoint)
				var invocation = new XMLHttpRequest();

				if (invocation){
					invocation.open('GET',mediaEndPoint,true);
					invocation.withCredentials = true;
					invocation.onreadystatechange = handler;
					invocation.send();
					dataType: 'jsonp';


				}
				function handler(evtXHR){
					if (invocation.readyState == 4)
					{
						if (invocation.status == 200)
						{
							var response = invocation.responseXML;
							// var invocationHistory = response.getElementsByTagName('invocationHistory').item(0).firstChild.data;
							// invocationHistoryText = document.createTextNode(invocationHistory);
							// var textDiv = document.getElementById("textDiv");
							// textDiv.appendChild(invocationHistoryText);
							alert("The Ajax call is working!")

						}
						else
							alert("Invocation Errors Occured");
					}
					else
						dump("currently the application is at" + invocation.readyState);






				};

			});
});

</script>









</head>
<body>
	<div id="panel">
		<input onclick="clearMarkers();" type=button value="Hide Markers">
		<input onclick="showMarkers();" type=button value="Show All Markers">
		<input onclick="deleteMarkers();" type=button value="Delete Markers">
	</div>
	<div id="map-canvas"></div>
	<!-- <p>Click on the map to add markers.</p> -->
	<div class="button">
		Get Photos
	</div>


<!--     <a href="https://api.instagram.com/oauth/authorize/?client_id=73a0892e379b495fb2d0d21ad092cbc4&redirect_uri=http://localhost:9393/
	&response_type=code">Log Into Instagram</a> -->

</body>
</html>
